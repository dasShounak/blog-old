<!DOCTYPE html>
<html lang="en">
  <head>
    <title>
  Network Programming Basics in C/C&#43;&#43; · Shounak Das
</title>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="color-scheme" content="light dark">


<meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests; block-all-mixed-content; default-src 'self'; child-src 'self'; font-src 'self' https://fonts.gstatic.com https://cdn.jsdelivr.net/; form-action 'self'; frame-src 'self' https://www.youtube.com; img-src 'self'; object-src 'none'; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com/ https://cdn.jsdelivr.net/; script-src 'self' 'unsafe-inline' https://www.google-analytics.com https://cdn.jsdelivr.net/ https://identity.netlify.com/; prefetch-src 'self'; connect-src 'self' https://www.google-analytics.com;">




<meta name="author" content="Shounak Das">
<meta name="description" content="Understanding network programming in C/C&#43;&#43; through a TCP client-server program">
<meta name="keywords" content="blog,developer,personal,hacker,ethical hacker,cybersecurity,security,hacking,penetration testing,develop,code,programming,coder,coding,developer blog,tech,technology,hacker mindset,how to hack,beginner,junior hacker,hack the world,hacking is an art,blue team,red team,forensics,hackthebox,tryhackme,tryhackme blog,htb,srm,srm university,cyber security,mobile security,social engineering,reconnaissance,information gathering,tcm">

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Network Programming Basics in C/C&#43;&#43;"/>
<meta name="twitter:description" content="Understanding network programming in C/C&#43;&#43; through a TCP client-server program"/>

<meta property="og:title" content="Network Programming Basics in C/C&#43;&#43;" />
<meta property="og:description" content="Understanding network programming in C/C&#43;&#43; through a TCP client-server program" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://shounakdas.netlify.app/posts/2023-11-17-network-programming-basics-in-c-c/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-11-17T10:34:16+00:00" />
<meta property="article:modified_time" content="2023-11-17T10:34:16+00:00" />






<link rel="canonical" href="https://shounakdas.netlify.app/posts/2023-11-17-network-programming-basics-in-c-c/">


<link rel="preload" href="/fonts/forkawesome-webfont.woff2?v=1.2.0" as="font" type="font/woff2" crossorigin>


  
  
  <link rel="stylesheet" href="/css/coder.min.0669b62fc2c181a12a4ba10be9984e385c9a5e83dc7cb7ae3759ad0b98d7e8b2.css" integrity="sha256-Bmm2L8LBgaEqS6EL6ZhOOFyaXoPcfLeuN1mtC5jX6LI=" crossorigin="anonymous" media="screen" />






  
    
    
    <link rel="stylesheet" href="/css/coder-dark.min.f6534b0b446b75d9b6ad77a97d43ede2ddaeff1b6e2361fb7198d6f8fcb7f83f.css" integrity="sha256-9lNLC0Rrddm2rXepfUPt4t2u/xtuI2H7cZjW&#43;Py3&#43;D8=" crossorigin="anonymous" media="screen" />
  



 




<link rel="icon" type="image/png" href="/images/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/images/favicon-16x16.png" sizes="16x16">

<link rel="apple-touch-icon" href="/images/apple-touch-icon.png">
<link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">

<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/images/safari-pinned-tab.svg" color="#5bbad5">




<meta name="generator" content="Hugo 0.92.2" />


<script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>


  </head>






<body class="preload-transitions colorscheme-dark">
  
<div class="float-container">
    <a id="dark-mode-toggle" class="colorscheme-toggle">
        <i class="fa fa-adjust fa-fw" aria-hidden="true"></i>
    </a>
</div>


  <main class="wrapper">
    <nav class="navigation">
  <section class="container">
    <a class="navigation-title" href="/">
      Shounak Das
    </a>
    
      <input type="checkbox" id="menu-toggle" />
      <label class="menu-button float-right" for="menu-toggle">
        <i class="fa fa-bars fa-fw" aria-hidden="true"></i>
      </label>
      <ul class="navigation-list">
        
          
            <li class="navigation-item">
              <a class="navigation-link" href="/about/">About</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link" href="/posts/">Blog</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link" href="/projects/">Projects</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link" href="/contact/">Contact me</a>
            </li>
          
        
        
      </ul>
    
  </section>
</nav>


    <div class="content">
      
  <section class="container post">
    <article>
      <header>
        <div class="post-title">
          <h1 class="title">
            <a class="title-link" href="https://shounakdas.netlify.app/posts/2023-11-17-network-programming-basics-in-c-c/">
              Network Programming Basics in C/C&#43;&#43;
            </a>
          </h1>
        </div>
        <div class="post-meta">
          <div class="date">
            <span class="posted-on">
              <i class="fa fa-calendar" aria-hidden="true"></i>
              <time datetime="2023-11-17T10:34:16Z">
                November 17, 2023
              </time>
            </span>
            <span class="reading-time">
              <i class="fa fa-clock-o" aria-hidden="true"></i>
              10-minute read
            </span>
          </div>
          
          
          <div class="tags">
  <i class="fa fa-tag" aria-hidden="true"></i>
    <span class="tag">
      <a href="/tags/programming/">programming</a>
    </span>
      <span class="separator">•</span>
    <span class="tag">
      <a href="/tags/networking/">networking</a>
    </span>
      <span class="separator">•</span>
    <span class="tag">
      <a href="/tags/tcp/">tcp</a>
    </span>
      <span class="separator">•</span>
    <span class="tag">
      <a href="/tags/c/">c</a>
    </span>
      <span class="separator">•</span>
    <span class="tag">
      <a href="/tags/c&#43;&#43;/">c&#43;&#43;</a>
    </span>
      <span class="separator">•</span>
    <span class="tag">
      <a href="/tags/sockets/">sockets</a>
    </span></div>

        </div>
      </header>

      <div class="post-content">
        
        <p>If you are here, I assume you are familiar with the terms &ldquo;network programming&rdquo; and &ldquo;socket programming&rdquo;. FYI, both these terms are used interchangeably as they are related concepts. Socket programming is a specific subset of network programming that focusses on communication between devices on different networks. It generally deals with the establishment, maintenance and termination of connections between applications. On the other hand, network programming is a much broader concept. It addresses the overall design and implementation of computer network infrastructures.</p>
<p>A quick google search on either term will give you results mostly in C/C++ and Python. The year is 2023, and people these days happen to prefer Python due to its simplicity and extensive modules. So, if you are familiar with Python, then I would recommend you to go through TCP and UDP client-server programs in Python. It will help you comprehend the wizardry of socket programming — the order of system calls might be confusing at the beginning.</p>
<p>When you compare the same Python code with its equivalent C/C++ program, you’ll notice that there is a lot more stuff happening in the later. This is because we have to define most of the things in C/C++. Whereas in Python, these are already pre-defined, we just need to put the values in proper places.</p>
<p>Before we begin, make sure you have a clear understanding of few essential concepts related to socket programming which, of course, I’m going to explain as simply and briefly as possible. Let’s see how a TCP client-server model is structured.</p>
<ol>
<li>First things first, we must know what a socket is? <strong>Socket is a file descriptor</strong> —  an <em>integer</em> associated with an open file. Basically, everything in Unix is just a file. A file can be a network connection, a pipe, or a real on-the-disk file, etc. When Unix programs do any sort of I/O operation, they do it by reading or writing to a file descriptor.</li>
<li>Once we have a socket file descriptor, we need to associate it with a port on our computer. This is done only when you are willing to listen to incoming connections, <em>i.e.</em>, a server needs to have listening port bound to the open socket. On the other hand, clients don’t need to do this as they are supposed to connect to a server to its listening port.</li>
<li>If a client tries to connect to the server on its listening port, the connection will be queued, waiting for the server to accept it. Once accepted, the client-server connection is successfully established and we can have a reliable communication between the server and the client.</li>
</ol>
<p>So let’s code this!</p>
<p>Like every other C++ program, we need to include the essential header files. We can also define macros for the port number and backlog (more on this later)</p>
<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#0f0;font-weight:bold">#include</span> <span style="color:#0f0;font-weight:bold">&lt;iostream&gt;</span><span style="color:#0f0;font-weight:bold">
</span><span style="color:#0f0;font-weight:bold">#include</span> <span style="color:#0f0;font-weight:bold">&lt;string&gt;</span><span style="color:#0f0;font-weight:bold">
</span><span style="color:#0f0;font-weight:bold">#include</span> <span style="color:#0f0;font-weight:bold">&lt;netdb.h&gt;</span><span style="color:#0f0;font-weight:bold">
</span><span style="color:#0f0;font-weight:bold">#include</span> <span style="color:#0f0;font-weight:bold">&lt;sys/types.h&gt;</span><span style="color:#0f0;font-weight:bold">
</span><span style="color:#0f0;font-weight:bold">#include</span> <span style="color:#0f0;font-weight:bold">&lt;sys/socket.h&gt;</span><span style="color:#0f0;font-weight:bold">
</span><span style="color:#0f0;font-weight:bold">#include</span> <span style="color:#0f0;font-weight:bold">&lt;arpa/inet.h&gt;</span><span style="color:#0f0;font-weight:bold">
</span><span style="color:#0f0;font-weight:bold">#include</span> <span style="color:#0f0;font-weight:bold">&lt;netinet/in.h&gt;</span><span style="color:#0f0;font-weight:bold">
</span><span style="color:#0f0;font-weight:bold"></span>
<span style="color:#0f0;font-weight:bold">#define PORT 1337
</span><span style="color:#0f0;font-weight:bold">#define BACKLOG 5
</span></code></pre></div><p>As we saw earlier, to set up a server/client, we need to create a socket which is basically an endpoint of communication over the network. Here’s the breakdown of the <code>socket()</code> system call.</p>
<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#fff;font-weight:bold">int</span> socket(<span style="color:#fff;font-weight:bold">int</span> domain, <span style="color:#fff;font-weight:bold">int</span> type, <span style="color:#fff;font-weight:bold">int</span> protocol);
</code></pre></div><ul>
<li><strong>domain:</strong> The address/protocol family (eg:- AF_INET, AF_INET6, PF_INET, etc.). AF_INET stands for <strong>Address Family Internet</strong> which specifies the use of IPv4, while AF_INET6 specifies the use of IPv6. PF_INET stands for <strong>Protocol Family Internet</strong>, which has the same functionalities of AF_INET. Historically, PF_INET was supposed to be used when calling <code>socket()</code>. But over time, AF_INET has become more prevalent. Though it doesn’t make any difference, but using PF_INET is the more correct thing to do.</li>
<li><strong>type:</strong> It specifies the type of protocol to be used. Mostly, either TCP (SOCK_STREAM) or UDP (SOCK_DGRAM) are used, but there are many more types available for specific purposes.</li>
<li><strong>protocol:</strong> We can set it to <code>0</code> to choose the appropriate protocol.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#fff;font-weight:bold">int</span> sockfd;
sockfd = socket(AF_INET, SOCK_STREAM, <span style="color:#ff0;font-weight:bold">0</span>);
</code></pre></div><p>Now we need to define the socket address structures. First, we need to understand the difference between <code>sockaddr</code> and <code>sockaddr_in</code>. Both represent socket addresses, but have different structures.</p>
<ul>
<li>
<p><strong>sockaddr:</strong> This is the generic structure used to define socket addresses. Most system calls accept arguments of this <code>struct sockaddr</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#fff;font-weight:bold">struct</span> sockaddr {
    <span style="color:#fff;font-weight:bold">unsigned</span> <span style="color:#fff;font-weight:bold">short</span> sa_family;   <span style="color:#007f7f">// Address family (e.g., AF_INET)
</span><span style="color:#007f7f"></span>    <span style="color:#fff;font-weight:bold">char</span> sa_data[<span style="color:#ff0;font-weight:bold">14</span>];           <span style="color:#007f7f">// Address data
</span><span style="color:#007f7f"></span>};
</code></pre></div></li>
<li>
<p><strong>sockaddr_in:</strong> This structure is specific to IPv4 addresses and contains more details about a socket address. So, it is preferred to use <code>struct sockaddr_in</code> when defining socket addresses initially, and then typecast it to <code>struct sockaddr</code> when passing it as an argument to a system call.</p>
<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#fff;font-weight:bold">struct</span> sockaddr_in {
    <span style="color:#fff;font-weight:bold">short</span> sin_family;           <span style="color:#007f7f">// Address family (AF_INET)
</span><span style="color:#007f7f"></span>    <span style="color:#fff;font-weight:bold">unsigned</span> <span style="color:#fff;font-weight:bold">short</span> sin_port;    <span style="color:#007f7f">// Port number
</span><span style="color:#007f7f"></span>    <span style="color:#fff;font-weight:bold">struct</span> in_addr sin_addr;    <span style="color:#007f7f">// IP address
</span><span style="color:#007f7f"></span>    <span style="color:#fff;font-weight:bold">char</span> sin_zero[<span style="color:#ff0;font-weight:bold">8</span>];           <span style="color:#007f7f">// Padding to make the structure the same size as sockaddr
</span><span style="color:#007f7f"></span>};
</code></pre></div><p><code>in_addr</code> is a structure used to define IPv4 addreses.</p>
<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#fff;font-weight:bold">struct</span> in_addr {
    in_addr_t s_addr;  <span style="color:#007f7f">// 32-bit IPv4 address
</span><span style="color:#007f7f"></span>};
</code></pre></div></li>
</ul>
<p>Looking at the structure of <code>struct sockaddr_in</code> (which we would be using for defining socket addresses for clarity and convenience), you can see that there are four members that need to be defined.</p>
<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#fff;font-weight:bold">struct</span> sockaddr_in server_addr;

server_addr.sin_family = AF_INET;
server_addr.sin_port = PORT;
server_addr.sin_addr.s_addr = INADDR_ANY;
</code></pre></div><p>We can skip <code>sin_zero</code> for now (no need for us to explore the deep waters so soon).</p>
<p>By now, you should be familiar with all the structs and constants that we used above, except <code>INADDR_ANY</code>. Well, it is special constant that binds the socket to all the available network interfaces on the host. This means, the socket will be able to receive incoming connections from or datagrams on any network interface.</p>
<p>FYI, network interfaces are basically the physical or virtual points of connection between computer and network. Fire up a terminal or command prompt and run the command <code>ifconfig</code> (if you are on Linux) or <code>ipconfig</code> (on Windows). You should see something like this:</p>
<p><img src="/images/ifconfig-output.png" alt="ifconfig output"></p>
<p>Here, <code>eth0</code> is the ethernet network interface. There are other types of interfaces, for example, <code>wlan0</code> for wireless interfaces and <code>tun0</code> for VPN interfaces.</p>
<p>You can also specify a single interface to bind with the socket by using the <code>inet_addr()</code> function and passing a IP address string to it. This function will convert the string to <code>struct in_addr</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp">sever_addr.sin_addr.s_addr = inet_addr(<span style="color:#f00">&#39;</span><span style="color:#ff0;font-weight:bold">127.0.0.1</span><span style="color:#f00">&#39;</span>);
</code></pre></div><p>We are now set to finally bind the server address to the socket.</p>
<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#fff;font-weight:bold">int</span> bind(<span style="color:#fff;font-weight:bold">int</span> sockfd, <span style="color:#fff;font-weight:bold">struct</span> sockaddr *my_addr, <span style="color:#fff;font-weight:bold">int</span> addrlen);
</code></pre></div><p><code>sockfd</code> is the socket file descriptor, <code>my_addr</code> is a pointer to the socket address and <code>addrlen</code> is the length of the socket address. So, let’s bind the server address we defined in the previous to our socket.</p>
<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp">bind(sockfd, (<span style="color:#fff;font-weight:bold">struct</span> sockaddr *)&amp;server_addr, <span style="color:#fff;font-weight:bold">sizeof</span> server_addr);
</code></pre></div><p>If you are wondering what gibberish is written in front of <code>server_addr</code>, well, recall that in C or C++ we can typecast one data type into another by specifying the new data type in brackets just in front of the variable to be typecasted.</p>
<p>Now, our server is ready to start listening for incoming connection requests (or datagrams, for UDP sockets). We can do so by calling the <code>listen()</code> system call which looks like this:</p>
<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#fff;font-weight:bold">int</span> listen(<span style="color:#fff;font-weight:bold">int</span> sockfd, <span style="color:#fff;font-weight:bold">int</span> backlog);
</code></pre></div><p>You might have stumbled across the term “backlog” earlier in this article when we defined the macros. Backlog is an integer value that specifies the maximum number of connection requests on the incoming queue. Connections queue up until they are accepted by the server. If the connection request exceeds this number, they will be dropped resulting in HTTP error. The default value is generally around 20, but you can use a lower value here, say 5.</p>
<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp">listen(sockfd, BACKLOG);
</code></pre></div><p>Now that our server is listening for connection requests, it needs to have the ability to accept a request. To do so, we use the <code>accept()</code> system call. It returns a socket file descriptor which contains information about the client, like IP address and port.</p>
<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#fff;font-weight:bold">int</span> accept(<span style="color:#fff;font-weight:bold">int</span> sockfd, <span style="color:#fff;font-weight:bold">struct</span> sockaddr *addr, socklen_t *addrlen);
</code></pre></div><p><code>sockfd</code> is the file descriptor of the listening socket, <code>addr</code> is a pointer to the local storage where client’s socket address information will be stored, and <code>addrlen</code> local integer variable that is set to the size of the client socket address (<code>struct sockaddr *addr</code>).</p>
<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#fff;font-weight:bold">int</span> clientfd;
<span style="color:#fff;font-weight:bold">struct</span> sockaddr_in client_addr;
socklen_t client_len;
client_len = <span style="color:#fff;font-weight:bold">sizeof</span> client_len;

clientfd = accept(sockfd, (<span style="color:#fff;font-weight:bold">struct</span> sockaddr *)&amp;client_addr, &amp;client_len);
</code></pre></div><p>That’s it! Our server is ready to <code>send()</code> and <code>recv()</code> data from the client now. So many system calls and <code>struct</code>s might be headache at the beginning. So let’s take a look at the sequence of system calls that we made:</p>
<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp">socket();      <span style="color:#007f7f">// Initialize socket file descriptor
</span><span style="color:#007f7f"></span>bind();        <span style="color:#007f7f">// Associate the socket with a local port
</span><span style="color:#007f7f"></span>listen();      <span style="color:#007f7f">// Wait for connection requests from client(s)
</span><span style="color:#007f7f"></span>accept();      <span style="color:#007f7f">// Complete the connection by accepting a client&#39;s request and initiating a client-server TCP communication channel
</span></code></pre></div><p>This was the <code>server.cpp</code>. Now, pause here and try to figure out what the <code>client.cpp</code> might look like. As you already know, we must create a socket in order to communicate with devices on other networks. But we don’t need to open a port to listen for incoming connections (that’s server stuff). What we should rather do is send a connection request to a server using the <code>connect()</code> system call. That’s all. We are then ready to communicate with the server.</p>
<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#fff;font-weight:bold">int</span> connect(<span style="color:#fff;font-weight:bold">int</span> sockfd, <span style="color:#fff;font-weight:bold">struct</span> sockaddr *serv_addr, <span style="color:#fff;font-weight:bold">int</span> addrlen);
</code></pre></div><p><code>sockfd</code> is the socket file descriptor, as always. <code>serv_addr</code> is a pointer to the server’s socket address and <code>addrlen</code> is an integer value specifying the size of this address.</p>
<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#fff;font-weight:bold">int</span> sockfd;
<span style="color:#fff;font-weight:bold">struct</span> sockaddr_in server_addr;

server_addr.sin_family = AF_INET;
server_addr.sin_port = PORT;
server_addr.sin_addr.s_addr = INADDR_ANY;

<span style="color:#007f7f">// Initialize socket
</span><span style="color:#007f7f"></span>sockfd = socket(AF_INET, SOCK_STREAM, <span style="color:#ff0;font-weight:bold">0</span>);

<span style="color:#007f7f">// Connect to server
</span><span style="color:#007f7f"></span>connect(sockfd, (<span style="color:#fff;font-weight:bold">struct</span> sockaddr *)&amp;server_addr, <span style="color:#fff;font-weight:bold">sizeof</span> server_addr);
</code></pre></div><p>This is what your client code should look like till now. To send data, we use the <code>send()</code> system call. And to receive data, we use the <code>recv()</code> system call.</p>
<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#fff;font-weight:bold">int</span> send(<span style="color:#fff;font-weight:bold">int</span> sockfd, <span style="color:#fff;font-weight:bold">const</span> <span style="color:#fff;font-weight:bold">void</span> *buff, <span style="color:#fff;font-weight:bold">int</span> len, <span style="color:#fff;font-weight:bold">int</span> flags);

<span style="color:#fff;font-weight:bold">int</span> recv(<span style="color:#fff;font-weight:bold">int</span> sockfd, <span style="color:#fff;font-weight:bold">void</span> *buff, <span style="color:#fff;font-weight:bold">int</span> len, <span style="color:#fff;font-weight:bold">int</span> flags);
</code></pre></div><p>Here, <code>buff</code> is a pointer to the data being sent or received. <code>len</code> is the length of the data in bytes and <code>flags</code> control the behavior of the operation. We can set it to 0.</p>
<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#007f7f">// server.cpp
</span><span style="color:#007f7f"></span>
<span style="color:#fff;font-weight:bold">char</span> buff[<span style="color:#ff0;font-weight:bold">1024</span>];

<span style="color:#fff;font-weight:bold">while</span> (<span style="color:#ff0;font-weight:bold">1</span>)
{
	recv(clientfd, buff, <span style="color:#fff;font-weight:bold">sizeof</span> buff, <span style="color:#ff0;font-weight:bold">0</span>);
	cout &lt;&lt; <span style="color:#0ff;font-weight:bold">&#34;Message received: &#34;</span> &lt;&lt; buff &lt;&lt; endl;
}
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#007f7f">// client.cpp
</span><span style="color:#007f7f"></span>
<span style="color:#fff;font-weight:bold">char</span> buff[<span style="color:#ff0;font-weight:bold">1024</span>];

<span style="color:#fff;font-weight:bold">while</span> (<span style="color:#ff0;font-weight:bold">1</span>)
{
  cout &lt;&lt; <span style="color:#0ff;font-weight:bold">&#34;</span><span style="color:#0ff;font-weight:bold">\n</span><span style="color:#0ff;font-weight:bold">Enter message: &#34;</span>;
  fgets(buff, <span style="color:#ff0;font-weight:bold">1024</span>, stdin);
  send(sockfd, buff, <span style="color:#fff;font-weight:bold">sizeof</span> buff + <span style="color:#ff0;font-weight:bold">1</span>, <span style="color:#ff0;font-weight:bold">0</span>);
  cout &lt;&lt; <span style="color:#0ff;font-weight:bold">&#34;Data sent successfully.&#34;</span> &lt;&lt; endl;
}
</code></pre></div><p>That’s it. After we’re done, we can close the socket using the <code>close()</code> system call.</p>
<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp">close(sockfd);
</code></pre></div><h2 id="complete-tcp-client-server-program">
  Complete TCP Client-Server program
  <a class="heading-link" href="#complete-tcp-client-server-program">
    <i class="fa fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<p>Server:</p>
<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#007f7f">//server.cpp
</span><span style="color:#007f7f"></span>
<span style="color:#0f0;font-weight:bold">#include</span> <span style="color:#0f0;font-weight:bold">&lt;iostream&gt;</span><span style="color:#0f0;font-weight:bold">
</span><span style="color:#0f0;font-weight:bold">#include</span> <span style="color:#0f0;font-weight:bold">&lt;string&gt;</span><span style="color:#0f0;font-weight:bold">
</span><span style="color:#0f0;font-weight:bold">#include</span> <span style="color:#0f0;font-weight:bold">&lt;cstring&gt;</span><span style="color:#0f0;font-weight:bold">
</span><span style="color:#0f0;font-weight:bold">#include</span> <span style="color:#0f0;font-weight:bold">&lt;netdb.h&gt;</span><span style="color:#0f0;font-weight:bold">
</span><span style="color:#0f0;font-weight:bold">#include</span> <span style="color:#0f0;font-weight:bold">&lt;sys/types.h&gt;</span><span style="color:#0f0;font-weight:bold">
</span><span style="color:#0f0;font-weight:bold">#include</span> <span style="color:#0f0;font-weight:bold">&lt;sys/socket.h&gt;</span><span style="color:#0f0;font-weight:bold">
</span><span style="color:#0f0;font-weight:bold">#include</span> <span style="color:#0f0;font-weight:bold">&lt;arpa/inet.h&gt;</span><span style="color:#0f0;font-weight:bold">
</span><span style="color:#0f0;font-weight:bold">#include</span> <span style="color:#0f0;font-weight:bold">&lt;netinet/in.h&gt;</span><span style="color:#0f0;font-weight:bold">
</span><span style="color:#0f0;font-weight:bold"></span>
<span style="color:#0f0;font-weight:bold">#define PORT 1234
</span><span style="color:#0f0;font-weight:bold">#define BACKLOG 5
</span><span style="color:#0f0;font-weight:bold"></span>
<span style="color:#fff;font-weight:bold">using</span> <span style="color:#fff;font-weight:bold">namespace</span> std;

<span style="color:#fff;font-weight:bold">int</span> main()
{

  <span style="color:#fff;font-weight:bold">int</span> sockfd, clientfd;
  <span style="color:#fff;font-weight:bold">char</span> buff[<span style="color:#ff0;font-weight:bold">1024</span>], ipstr[INET6_ADDRSTRLEN];
  <span style="color:#fff;font-weight:bold">struct</span> sockaddr_in server_addr, client_addr;
  socklen_t client_len;
  client_len = <span style="color:#fff;font-weight:bold">sizeof</span> client_addr;

  server_addr.sin_family = AF_INET;
  server_addr.sin_port = PORT;
  <span style="color:#007f7f">// server_addr.sin_addr.s_addr = inet_addr(&#34;127.0.0.1&#34;);
</span><span style="color:#007f7f"></span>  server_addr.sin_addr.s_addr = INADDR_ANY;

  <span style="color:#007f7f">// Initialize socket
</span><span style="color:#007f7f"></span>  sockfd = socket(AF_INET, SOCK_STREAM, <span style="color:#ff0;font-weight:bold">0</span>);

  <span style="color:#007f7f">// Bind socket to local port
</span><span style="color:#007f7f"></span>  bind(sockfd, (<span style="color:#fff;font-weight:bold">struct</span> sockaddr *)&amp;server_addr, <span style="color:#fff;font-weight:bold">sizeof</span> server_addr);

  <span style="color:#007f7f">// Start listening on opened port
</span><span style="color:#007f7f"></span>  listen(sockfd, BACKLOG);
  cout &lt;&lt; <span style="color:#0ff;font-weight:bold">&#34;Listening on &#34;</span> &lt;&lt; PORT &lt;&lt; <span style="color:#0ff;font-weight:bold">&#34;...&#34;</span> &lt;&lt; endl;

  <span style="color:#007f7f">// Accept connection request from client
</span><span style="color:#007f7f"></span>  clientfd = accept(sockfd, (<span style="color:#fff;font-weight:bold">struct</span> sockaddr *)&amp;client_addr, &amp;client_len);

  inet_ntop(AF_INET, &amp;client_addr.sin_addr, ipstr, <span style="color:#fff;font-weight:bold">sizeof</span> ipstr);
  cout &lt;&lt; <span style="color:#0ff;font-weight:bold">&#34;Accepted connection from &#34;</span> &lt;&lt; ipstr &lt;&lt; <span style="color:#0ff;font-weight:bold">&#34;.</span><span style="color:#0ff;font-weight:bold">\n</span><span style="color:#0ff;font-weight:bold">&#34;</span>
       &lt;&lt; endl;

  <span style="color:#007f7f">// Recieve messages from server
</span><span style="color:#007f7f"></span>  <span style="color:#fff;font-weight:bold">while</span> (<span style="color:#ff0;font-weight:bold">1</span>)
  {
    recv(clientfd, buff, <span style="color:#fff;font-weight:bold">sizeof</span> buff, <span style="color:#ff0;font-weight:bold">0</span>);
    cout &lt;&lt; <span style="color:#0ff;font-weight:bold">&#34;Message recieved: &#34;</span> &lt;&lt; buff &lt;&lt; <span style="color:#0ff;font-weight:bold">&#34;</span><span style="color:#0ff;font-weight:bold">\n</span><span style="color:#0ff;font-weight:bold">&#34;</span>
         &lt;&lt; endl;
  }
}
</code></pre></div><p>Client:</p>
<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#007f7f">// client.cpp
</span><span style="color:#007f7f"></span>
<span style="color:#0f0;font-weight:bold">#include</span> <span style="color:#0f0;font-weight:bold">&lt;iostream&gt;</span><span style="color:#0f0;font-weight:bold">
</span><span style="color:#0f0;font-weight:bold">#include</span> <span style="color:#0f0;font-weight:bold">&lt;string&gt;</span><span style="color:#0f0;font-weight:bold">
</span><span style="color:#0f0;font-weight:bold">#include</span> <span style="color:#0f0;font-weight:bold">&lt;cstring&gt;</span><span style="color:#0f0;font-weight:bold">
</span><span style="color:#0f0;font-weight:bold">#include</span> <span style="color:#0f0;font-weight:bold">&lt;netdb.h&gt;</span><span style="color:#0f0;font-weight:bold">
</span><span style="color:#0f0;font-weight:bold">#include</span> <span style="color:#0f0;font-weight:bold">&lt;sys/types.h&gt;</span><span style="color:#0f0;font-weight:bold">
</span><span style="color:#0f0;font-weight:bold">#include</span> <span style="color:#0f0;font-weight:bold">&lt;sys/socket.h&gt;</span><span style="color:#0f0;font-weight:bold">
</span><span style="color:#0f0;font-weight:bold">#include</span> <span style="color:#0f0;font-weight:bold">&lt;arpa/inet.h&gt;</span><span style="color:#0f0;font-weight:bold">
</span><span style="color:#0f0;font-weight:bold">#include</span> <span style="color:#0f0;font-weight:bold">&lt;netinet/in.h&gt;</span><span style="color:#0f0;font-weight:bold">
</span><span style="color:#0f0;font-weight:bold"></span>
<span style="color:#0f0;font-weight:bold">#define PORT 1234
</span><span style="color:#0f0;font-weight:bold"></span>
<span style="color:#fff;font-weight:bold">using</span> <span style="color:#fff;font-weight:bold">namespace</span> std;

<span style="color:#fff;font-weight:bold">int</span> main()
{

  <span style="color:#fff;font-weight:bold">int</span> sockfd;
  <span style="color:#fff;font-weight:bold">char</span> buff[<span style="color:#ff0;font-weight:bold">1024</span>];
  <span style="color:#fff;font-weight:bold">struct</span> sockaddr_in server_addr;

  server_addr.sin_family = AF_INET;
  server_addr.sin_port = PORT;
  server_addr.sin_addr.s_addr = INADDR_ANY;

  <span style="color:#007f7f">// Initialize socket
</span><span style="color:#007f7f"></span>  sockfd = socket(AF_INET, SOCK_STREAM, <span style="color:#ff0;font-weight:bold">0</span>);

  <span style="color:#007f7f">// Connect to server
</span><span style="color:#007f7f"></span>  connect(sockfd, (<span style="color:#fff;font-weight:bold">struct</span> sockaddr *)&amp;server_addr, <span style="color:#fff;font-weight:bold">sizeof</span> server_addr);

  <span style="color:#007f7f">// Send message
</span><span style="color:#007f7f"></span>  <span style="color:#fff;font-weight:bold">while</span> (<span style="color:#ff0;font-weight:bold">1</span>)
  {
    cout &lt;&lt; <span style="color:#0ff;font-weight:bold">&#34;</span><span style="color:#0ff;font-weight:bold">\n</span><span style="color:#0ff;font-weight:bold">Enter message: &#34;</span>;
    fgets(buff, <span style="color:#ff0;font-weight:bold">1024</span>, stdin);
    send(sockfd, buff, <span style="color:#fff;font-weight:bold">sizeof</span> buff + <span style="color:#ff0;font-weight:bold">1</span>, <span style="color:#ff0;font-weight:bold">0</span>);
    cout &lt;&lt; <span style="color:#0ff;font-weight:bold">&#34;Data sent successfully.&#34;</span>
         &lt;&lt; endl;
  }
}
</code></pre></div><p>I have created a <a href="https://github.com/dasShounak/network-programming/"  class="external-link" target="_blank" rel="noopener">GitHub</a>
 repository where I have uploaded both these programs. I&rsquo;ll be updating it with more network programs soon. Go fork this repo to your own GitHub. Thanks for reading.</p>
<p><em>84ck_783_914n37</em></p>

      </div>


      <footer>
        

<section class="see-also">
  
    
    
    
  
</section>


        
        
        
        
      </footer>
    </article>

    
  </section>

    </div>

    <footer class="footer">
  <section class="container">
    ©
    
    2023
     Shounak Das 
    
    
    
  </section>
</footer>

  </main>

  

  
  
  <script src="/js/coder.min.369d90111ae4409b4e51de5efd23a46b92663fcc82dc9a0efde7f70bffc3f949.js" integrity="sha256-Np2QERrkQJtOUd5e/SOka5JmP8yC3JoO/ef3C//D&#43;Uk="></script>
  

  

  


  

  

  

  

  

  

  

  

  

  

  
</body>

</html>
